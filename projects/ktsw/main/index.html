
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://blog.gmora.work/projects/ktsw/main/">
      
      
        <link rel="prev" href="../../../cheatsheets/promQL/">
      
      
      
        
      
      
      <link rel="icon" href="../../../assets/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.1">
    
    
      
        <title>KTSW: Kubernetes The Sweaty Way - Mora's blog</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.484c7ddc.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="deep-purple">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#ktsw-kubernetes-the-sweaty-way" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="Mora&#39;s blog" class="md-header__button md-logo" aria-label="Mora's blog" data-md-component="logo">
      
  <img src="../../../assets/logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Mora's blog
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              KTSW: Kubernetes The Sweaty Way
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="deep-purple"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="black" data-md-color-accent="deep-purple"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../.." class="md-tabs__link">
        
  
  
    
  
  Welcome

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../blog/SLOs/" class="md-tabs__link">
          
  
  
  Blog

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../books/Site%20Reliability%20Engineering/Chapter%201/" class="md-tabs__link">
          
  
  
  Books

        </a>
      </li>
    
  

    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../cheatsheets/grafana_dashboards/" class="md-tabs__link">
          
  
  
  Cheatsheets

        </a>
      </li>
    
  

      
        
  
  
  
    
  
  
    
    
      
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="./" class="md-tabs__link">
          
  
  
  Projects

        </a>
      </li>
    
  

    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="Mora&#39;s blog" class="md-nav__button md-logo" aria-label="Mora's blog" data-md-component="logo">
      
  <img src="../../../assets/logo.png" alt="logo">

    </a>
    Mora's blog
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Welcome
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Blog
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Blog
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../blog/SLOs/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    SLIs, SLOs, and SLAs
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Books
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Books
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1" >
        
          
          <label class="md-nav__link" for="__nav_3_1" id="__nav_3_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Site Reliability Engineering
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1">
            <span class="md-nav__icon md-icon"></span>
            
  
    Site Reliability Engineering
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../books/Site%20Reliability%20Engineering/Chapter%201/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter 1 - Introduction
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Cheatsheets
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Cheatsheets
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../cheatsheets/grafana_dashboards/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Grafana Dashboards: A Complete Guide
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../cheatsheets/logQL/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    LogQL Cheat Sheet
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../cheatsheets/mkdocs_cheatsheet/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Mkdocs - Material cheatsheet
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../cheatsheets/promQL/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    PromQL Cheat Sheet
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" checked>
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Projects
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    Projects
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_1" checked>
        
          
          <label class="md-nav__link" for="__nav_5_1" id="__nav_5_1_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Ktsw
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5_1">
            <span class="md-nav__icon md-icon"></span>
            
  
    Ktsw
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    KTSW: Kubernetes The Sweaty Way
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    KTSW: Kubernetes The Sweaty Way
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1-vision-general-del-proyecto" class="md-nav__link">
    <span class="md-ellipsis">
      
        1. Visión General del Proyecto
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-filosofia-de-arquitectura" class="md-nav__link">
    <span class="md-ellipsis">
      
        2. Filosofía de Arquitectura
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2. Filosofía de Arquitectura">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#complejidad-justificada-vs-accidental" class="md-nav__link">
    <span class="md-ellipsis">
      
        Complejidad Justificada vs. Accidental
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#matriz-de-decisiones-tecnicas" class="md-nav__link">
    <span class="md-ellipsis">
      
        Matriz de Decisiones Técnicas
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-arquitectura-del-sistema" class="md-nav__link">
    <span class="md-ellipsis">
      
        3. Arquitectura del Sistema
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-stack-tecnologico-detallado" class="md-nav__link">
    <span class="md-ellipsis">
      
        4. Stack Tecnológico Detallado
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="4. Stack Tecnológico Detallado">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#capa-1-infraestructura-y-virtualizacion" class="md-nav__link">
    <span class="md-ellipsis">
      
        Capa 1: Infraestructura y Virtualización
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Capa 1: Infraestructura y Virtualización">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-proxmox-ve-hypervisor" class="md-nav__link">
    <span class="md-ellipsis">
      
        1. Proxmox VE (Hypervisor)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-segmentacion-de-red-vlans-8021q" class="md-nav__link">
    <span class="md-ellipsis">
      
        2. Segmentación de Red (VLANs 802.1Q)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-pfsenseopnsense-edge-router" class="md-nav__link">
    <span class="md-ellipsis">
      
        3. pfSense/OPNsense (Edge Router)
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#capa-2-kubernetes-networking-cni-bgp" class="md-nav__link">
    <span class="md-ellipsis">
      
        Capa 2: Kubernetes Networking (CNI &amp; BGP)
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Capa 2: Kubernetes Networking (CNI &amp; BGP)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#4-cilium-cni-security" class="md-nav__link">
    <span class="md-ellipsis">
      
        4. Cilium (CNI &amp; Security)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5-metallb-load-balancing" class="md-nav__link">
    <span class="md-ellipsis">
      
        5. MetalLB (Load Balancing)
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#capa-3-plataforma-y-gitops" class="md-nav__link">
    <span class="md-ellipsis">
      
        Capa 3: Plataforma y GitOps
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Capa 3: Plataforma y GitOps">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#6-fluxcd-gitops-controller" class="md-nav__link">
    <span class="md-ellipsis">
      
        6. FluxCD (GitOps Controller)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#7-tekton-ci-pipelines" class="md-nav__link">
    <span class="md-ellipsis">
      
        7. Tekton (CI Pipelines)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#8-harbor-container-registry" class="md-nav__link">
    <span class="md-ellipsis">
      
        8. Harbor (Container Registry)
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#capa-4-seguridad-y-politicas" class="md-nav__link">
    <span class="md-ellipsis">
      
        Capa 4: Seguridad y Políticas
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Capa 4: Seguridad y Políticas">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#9-opa-gatekeeper-policy-engine" class="md-nav__link">
    <span class="md-ellipsis">
      
        9. OPA Gatekeeper (Policy Engine)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#10-gestion-de-secretos-sops-age" class="md-nav__link">
    <span class="md-ellipsis">
      
        10. Gestión de Secretos (SOPS + Age)
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#capa-5-observabilidad-stack-lgtm" class="md-nav__link">
    <span class="md-ellipsis">
      
        Capa 5: Observabilidad (Stack LGTM)
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Capa 5: Observabilidad (Stack LGTM)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#11-victoriametrics-metricas" class="md-nav__link">
    <span class="md-ellipsis">
      
        11. VictoriaMetrics (Métricas)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#12-loki-logs" class="md-nav__link">
    <span class="md-ellipsis">
      
        12. Loki (Logs)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#13-tempo-trazas-distribuidas" class="md-nav__link">
    <span class="md-ellipsis">
      
        13. Tempo (Trazas Distribuidas)
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#capa-6-datos-y-persistencia" class="md-nav__link">
    <span class="md-ellipsis">
      
        Capa 6: Datos y Persistencia
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Capa 6: Datos y Persistencia">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#14-longhorn-block-storage" class="md-nav__link">
    <span class="md-ellipsis">
      
        14. Longhorn (Block Storage)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#15-cloudnativepg-postgresql" class="md-nav__link">
    <span class="md-ellipsis">
      
        15. CloudNativePG (PostgreSQL)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#16-nats-jetstream-messaging" class="md-nav__link">
    <span class="md-ellipsis">
      
        16. NATS JetStream (Messaging)
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-aplicacion-de-referencia-distributed-task-processor" class="md-nav__link">
    <span class="md-ellipsis">
      
        5. Aplicación de Referencia: "Distributed Task Processor"
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#6-roadmap-de-implementacion" class="md-nav__link">
    <span class="md-ellipsis">
      
        6. Roadmap de Implementación
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="6. Roadmap de Implementación">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#fase-0-fundamentos-la-base-fisica" class="md-nav__link">
    <span class="md-ellipsis">
      
        Fase 0: Fundamentos (La Base Física)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fase-1-conectividad-y-seguridad-la-red" class="md-nav__link">
    <span class="md-ellipsis">
      
        Fase 1: Conectividad y Seguridad (La Red)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fase-2-control-y-gitops-el-cerebro" class="md-nav__link">
    <span class="md-ellipsis">
      
        Fase 2: Control y GitOps (El Cerebro)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fase-3-observabilidad-los-ojos" class="md-nav__link">
    <span class="md-ellipsis">
      
        Fase 3: Observabilidad (Los Ojos)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fase-4-datos-y-plataforma-el-musculo" class="md-nav__link">
    <span class="md-ellipsis">
      
        Fase 4: Datos y Plataforma (El Músculo)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fase-5-aplicacion-y-pipelines-la-carga" class="md-nav__link">
    <span class="md-ellipsis">
      
        Fase 5: Aplicación y Pipelines (La Carga)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fase-6-operaciones-dia-2-y-caos-la-prueba-de-fuego" class="md-nav__link">
    <span class="md-ellipsis">
      
        Fase 6: Operaciones Día 2 y Caos (La Prueba de Fuego)
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1-vision-general-del-proyecto" class="md-nav__link">
    <span class="md-ellipsis">
      
        1. Visión General del Proyecto
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-filosofia-de-arquitectura" class="md-nav__link">
    <span class="md-ellipsis">
      
        2. Filosofía de Arquitectura
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2. Filosofía de Arquitectura">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#complejidad-justificada-vs-accidental" class="md-nav__link">
    <span class="md-ellipsis">
      
        Complejidad Justificada vs. Accidental
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#matriz-de-decisiones-tecnicas" class="md-nav__link">
    <span class="md-ellipsis">
      
        Matriz de Decisiones Técnicas
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-arquitectura-del-sistema" class="md-nav__link">
    <span class="md-ellipsis">
      
        3. Arquitectura del Sistema
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-stack-tecnologico-detallado" class="md-nav__link">
    <span class="md-ellipsis">
      
        4. Stack Tecnológico Detallado
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="4. Stack Tecnológico Detallado">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#capa-1-infraestructura-y-virtualizacion" class="md-nav__link">
    <span class="md-ellipsis">
      
        Capa 1: Infraestructura y Virtualización
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Capa 1: Infraestructura y Virtualización">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-proxmox-ve-hypervisor" class="md-nav__link">
    <span class="md-ellipsis">
      
        1. Proxmox VE (Hypervisor)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-segmentacion-de-red-vlans-8021q" class="md-nav__link">
    <span class="md-ellipsis">
      
        2. Segmentación de Red (VLANs 802.1Q)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-pfsenseopnsense-edge-router" class="md-nav__link">
    <span class="md-ellipsis">
      
        3. pfSense/OPNsense (Edge Router)
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#capa-2-kubernetes-networking-cni-bgp" class="md-nav__link">
    <span class="md-ellipsis">
      
        Capa 2: Kubernetes Networking (CNI &amp; BGP)
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Capa 2: Kubernetes Networking (CNI &amp; BGP)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#4-cilium-cni-security" class="md-nav__link">
    <span class="md-ellipsis">
      
        4. Cilium (CNI &amp; Security)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5-metallb-load-balancing" class="md-nav__link">
    <span class="md-ellipsis">
      
        5. MetalLB (Load Balancing)
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#capa-3-plataforma-y-gitops" class="md-nav__link">
    <span class="md-ellipsis">
      
        Capa 3: Plataforma y GitOps
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Capa 3: Plataforma y GitOps">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#6-fluxcd-gitops-controller" class="md-nav__link">
    <span class="md-ellipsis">
      
        6. FluxCD (GitOps Controller)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#7-tekton-ci-pipelines" class="md-nav__link">
    <span class="md-ellipsis">
      
        7. Tekton (CI Pipelines)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#8-harbor-container-registry" class="md-nav__link">
    <span class="md-ellipsis">
      
        8. Harbor (Container Registry)
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#capa-4-seguridad-y-politicas" class="md-nav__link">
    <span class="md-ellipsis">
      
        Capa 4: Seguridad y Políticas
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Capa 4: Seguridad y Políticas">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#9-opa-gatekeeper-policy-engine" class="md-nav__link">
    <span class="md-ellipsis">
      
        9. OPA Gatekeeper (Policy Engine)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#10-gestion-de-secretos-sops-age" class="md-nav__link">
    <span class="md-ellipsis">
      
        10. Gestión de Secretos (SOPS + Age)
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#capa-5-observabilidad-stack-lgtm" class="md-nav__link">
    <span class="md-ellipsis">
      
        Capa 5: Observabilidad (Stack LGTM)
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Capa 5: Observabilidad (Stack LGTM)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#11-victoriametrics-metricas" class="md-nav__link">
    <span class="md-ellipsis">
      
        11. VictoriaMetrics (Métricas)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#12-loki-logs" class="md-nav__link">
    <span class="md-ellipsis">
      
        12. Loki (Logs)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#13-tempo-trazas-distribuidas" class="md-nav__link">
    <span class="md-ellipsis">
      
        13. Tempo (Trazas Distribuidas)
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#capa-6-datos-y-persistencia" class="md-nav__link">
    <span class="md-ellipsis">
      
        Capa 6: Datos y Persistencia
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Capa 6: Datos y Persistencia">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#14-longhorn-block-storage" class="md-nav__link">
    <span class="md-ellipsis">
      
        14. Longhorn (Block Storage)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#15-cloudnativepg-postgresql" class="md-nav__link">
    <span class="md-ellipsis">
      
        15. CloudNativePG (PostgreSQL)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#16-nats-jetstream-messaging" class="md-nav__link">
    <span class="md-ellipsis">
      
        16. NATS JetStream (Messaging)
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-aplicacion-de-referencia-distributed-task-processor" class="md-nav__link">
    <span class="md-ellipsis">
      
        5. Aplicación de Referencia: "Distributed Task Processor"
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#6-roadmap-de-implementacion" class="md-nav__link">
    <span class="md-ellipsis">
      
        6. Roadmap de Implementación
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="6. Roadmap de Implementación">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#fase-0-fundamentos-la-base-fisica" class="md-nav__link">
    <span class="md-ellipsis">
      
        Fase 0: Fundamentos (La Base Física)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fase-1-conectividad-y-seguridad-la-red" class="md-nav__link">
    <span class="md-ellipsis">
      
        Fase 1: Conectividad y Seguridad (La Red)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fase-2-control-y-gitops-el-cerebro" class="md-nav__link">
    <span class="md-ellipsis">
      
        Fase 2: Control y GitOps (El Cerebro)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fase-3-observabilidad-los-ojos" class="md-nav__link">
    <span class="md-ellipsis">
      
        Fase 3: Observabilidad (Los Ojos)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fase-4-datos-y-plataforma-el-musculo" class="md-nav__link">
    <span class="md-ellipsis">
      
        Fase 4: Datos y Plataforma (El Músculo)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fase-5-aplicacion-y-pipelines-la-carga" class="md-nav__link">
    <span class="md-ellipsis">
      
        Fase 5: Aplicación y Pipelines (La Carga)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fase-6-operaciones-dia-2-y-caos-la-prueba-de-fuego" class="md-nav__link">
    <span class="md-ellipsis">
      
        Fase 6: Operaciones Día 2 y Caos (La Prueba de Fuego)
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="ktsw-kubernetes-the-sweaty-way">KTSW: Kubernetes The Sweaty Way<a class="headerlink" href="#ktsw-kubernetes-the-sweaty-way" title="Permanent link">&para;</a></h1>
<h2 id="1-vision-general-del-proyecto">1. Visión General del Proyecto<a class="headerlink" href="#1-vision-general-del-proyecto" title="Permanent link">&para;</a></h2>
<p><strong>KTSW</strong> es una iniciativa de ingeniería diseñada bajo una premisa fundamental: <strong>la competencia técnica se forja en la fricción.</strong></p>
<p>La mayoría de los tutoriales y herramientas modernas de DevOps (EKS, GKE, herramientas "magic-box") buscan abstraer la complejidad, ofreciendo caminos felices que ocultan el funcionamiento interno de los sistemas. Este proyecto hace lo contrario. El objetivo es construir un entorno de homelab tan técnicamente demandante y granular que la operación de infraestructuras empresariales de producción parezca trivial en comparación.</p>
<p>Si <em>Linux From Scratch</em> es la forja para entender el sistema operativo, <strong>KTSW</strong> es la forja para entender la orquestación de sistemas distribuidos a escala.</p>
<hr />
<h2 id="2-filosofia-de-arquitectura">2. Filosofía de Arquitectura<a class="headerlink" href="#2-filosofia-de-arquitectura" title="Permanent link">&para;</a></h2>
<h3 id="complejidad-justificada-vs-accidental">Complejidad Justificada vs. Accidental<a class="headerlink" href="#complejidad-justificada-vs-accidental" title="Permanent link">&para;</a></h3>
<p>Es crucial distinguir entre complejidad accidental (configuraciones malas) y complejidad esencial (necesaria para resolver problemas difíciles). KTSW implementa <strong>complejidad esencial de nivel enterprise</strong> en un entorno controlado.</p>
<div class="admonition quote">
<p class="admonition-title">El Principio de Sobrecarga Progresiva</p>
</div>
<p>Implementamos tecnologías que resuelven problemas de escala masiva (Service Mesh, BGP, Distributed Tracing) aunque la escala de tráfico actual no lo requiera obligatoriamente, con el fin de dominar la solución técnica antes de que el problema operativo aparezca.</p>
<h3 id="matriz-de-decisiones-tecnicas">Matriz de Decisiones Técnicas<a class="headerlink" href="#matriz-de-decisiones-tecnicas" title="Permanent link">&para;</a></h3>
<div class="tabbed-set tabbed-alternate" data-tabs="1:1"><input checked="checked" id="__tabbed_1_1" name="__tabbed_1" type="radio" /><div class="tabbed-labels"><label for="__tabbed_1_1">Enfoque Tradicional / Fácil</label></div>
<div class="tabbed-content">
<div class="tabbed-block"></div>
</div>
</div>
<ul>
<li>LoadBalancers gestionados por la nube (ALB/ELB).</li>
<li>Seguridad perimetral básica (Security Groups).</li>
<li>Observabilidad reactiva (logs cuando algo falla).</li>
<li>Despliegues manuales o scripts imperativos.</li>
<li>Networking plano y confiable por defecto.</li>
</ul>
<div class="tabbed-set tabbed-alternate" data-tabs="2:1"><input checked="checked" id="__tabbed_2_1" name="__tabbed_2" type="radio" /><div class="tabbed-labels"><label for="__tabbed_2_1">Enfoque KTSW / Enterprise</label></div>
<div class="tabbed-content">
<div class="tabbed-block"></div>
</div>
</div>
<ul>
<li>Implementación de <strong>BGP</strong> y anuncio de rutas propias (MetalLB/FRR).</li>
<li><strong>Zero Trust Networking</strong> y mTLS estricto intra-cluster.</li>
<li>Observabilidad continua basada en <strong>eBPF</strong> y trazas distribuidas.</li>
<li><strong>GitOps estricto</strong> con reconciliación automática.</li>
<li>Network Policies de denegación por defecto (Default Deny).</li>
</ul>
<hr />
<h2 id="3-arquitectura-del-sistema">3. Arquitectura del Sistema<a class="headerlink" href="#3-arquitectura-del-sistema" title="Permanent link">&para;</a></h2>
<p>El diseño sigue un modelo de capas estrictas de abstracción.</p>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>graph TD
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    subgraph Infrastructure [Capa de Infraestructura]
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>        Hypervisor[Proxmox VE]
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>        Network[VLAN Segmentation]
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>        Router[pfSense/OPNsense]
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>    end
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>    subgraph Orchestration [Capa de Orquestación]
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a>        K8s[Kubernetes Core]
</span><span id="__span-0-10"><a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a>        Cilium[Cilium CNI + eBPF]
</span><span id="__span-0-11"><a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a>        MetalLB[MetalLB BGP]
</span><span id="__span-0-12"><a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a>    end
</span><span id="__span-0-13"><a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a>
</span><span id="__span-0-14"><a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a>    subgraph Platform [Capa de Plataforma]
</span><span id="__span-0-15"><a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a>        GitOps[FluxCD]
</span><span id="__span-0-16"><a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a>        Mesh[Linkerd Service Mesh]
</span><span id="__span-0-17"><a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a>        Ingress[Traefik Ingress]
</span><span id="__span-0-18"><a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a>        Sec[OPA Gatekeeper]
</span><span id="__span-0-19"><a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a>    end
</span><span id="__span-0-20"><a id="__codelineno-0-20" name="__codelineno-0-20" href="#__codelineno-0-20"></a>
</span><span id="__span-0-21"><a id="__codelineno-0-21" name="__codelineno-0-21" href="#__codelineno-0-21"></a>    subgraph Observability [Capa de Observabilidad]
</span><span id="__span-0-22"><a id="__codelineno-0-22" name="__codelineno-0-22" href="#__codelineno-0-22"></a>        Loki[Loki - Logs]
</span><span id="__span-0-23"><a id="__codelineno-0-23" name="__codelineno-0-23" href="#__codelineno-0-23"></a>        Tempo[Tempo - Traces]
</span><span id="__span-0-24"><a id="__codelineno-0-24" name="__codelineno-0-24" href="#__codelineno-0-24"></a>        Vic[VictoriaMetrics - Metrics]
</span><span id="__span-0-25"><a id="__codelineno-0-25" name="__codelineno-0-25" href="#__codelineno-0-25"></a>        Graf[Grafana - Visualization]
</span><span id="__span-0-26"><a id="__codelineno-0-26" name="__codelineno-0-26" href="#__codelineno-0-26"></a>    end
</span><span id="__span-0-27"><a id="__codelineno-0-27" name="__codelineno-0-27" href="#__codelineno-0-27"></a>
</span><span id="__span-0-28"><a id="__codelineno-0-28" name="__codelineno-0-28" href="#__codelineno-0-28"></a>    Infrastructure --&gt; Orchestration
</span><span id="__span-0-29"><a id="__codelineno-0-29" name="__codelineno-0-29" href="#__codelineno-0-29"></a>    Orchestration --&gt; Platform
</span><span id="__span-0-30"><a id="__codelineno-0-30" name="__codelineno-0-30" href="#__codelineno-0-30"></a>    Platform --&gt; Observability
</span></code></pre></div>
<hr />
<h2 id="4-stack-tecnologico-detallado">4. Stack Tecnológico Detallado<a class="headerlink" href="#4-stack-tecnologico-detallado" title="Permanent link">&para;</a></h2>
<h3 id="capa-1-infraestructura-y-virtualizacion">Capa 1: Infraestructura y Virtualización<a class="headerlink" href="#capa-1-infraestructura-y-virtualizacion" title="Permanent link">&para;</a></h3>
<p>El control comienza en el "metal". Rechazamos instancias de nube pública para forzar el manejo de recursos físicos y redes L2/L3.</p>
<h4 id="1-proxmox-ve-hypervisor">1. Proxmox VE (Hypervisor)<a class="headerlink" href="#1-proxmox-ve-hypervisor" title="Permanent link">&para;</a></h4>
<ul>
<li><strong>Justificación:</strong> Permite la gestión de recursos a nivel de kernel (KVM/LXC) y la simulación de topologías de red complejas mediante Open vSwitch.</li>
<li><strong>Objetivo Técnico:</strong> Comprender la diferencia entre aislamiento por virtualización completa y paravirtualización, así como la gestión de storage pools (ZFS).</li>
</ul>
<h4 id="2-segmentacion-de-red-vlans-8021q">2. Segmentación de Red (VLANs 802.1Q)<a class="headerlink" href="#2-segmentacion-de-red-vlans-8021q" title="Permanent link">&para;</a></h4>
<p>La red no es plana. Separamos tráfico para simular un entorno de centro de datos real.</p>
<ul>
<li><strong>VLAN 10 (Mgmt):</strong> Plano de control, SSH, Proxmox UI.</li>
<li><strong>VLAN 20 (Nodes):</strong> Tráfico de Kubelet, etcd y overlay network.</li>
<li><strong>VLAN 30 (Storage):</strong> Tráfico dedicado iSCSI/NFS/Longhorn para evitar latencia en apps.</li>
<li><strong>VLAN 40 (Public):</strong> VIPs expuestas por el LoadBalancer.</li>
</ul>
<h4 id="3-pfsenseopnsense-edge-router">3. pfSense/OPNsense (Edge Router)<a class="headerlink" href="#3-pfsenseopnsense-edge-router" title="Permanent link">&para;</a></h4>
<ul>
<li><strong>Justificación:</strong> Actúa como gateway perimetral, gestionando VPNs (WireGuard), DNS Resolver (Unbound) y reglas de firewall stateful entre VLANs.</li>
</ul>
<hr />
<h3 id="capa-2-kubernetes-networking-cni-bgp">Capa 2: Kubernetes Networking (CNI &amp; BGP)<a class="headerlink" href="#capa-2-kubernetes-networking-cni-bgp" title="Permanent link">&para;</a></h3>
<p>Aquí reside gran parte de la complejidad intencional.</p>
<h4 id="4-cilium-cni-security">4. Cilium (CNI &amp; Security)<a class="headerlink" href="#4-cilium-cni-security" title="Permanent link">&para;</a></h4>
<p>Utilizamos Cilium para reemplazar <code>kube-proxy</code>.</p>
<ul>
<li><strong>Tecnología:</strong> <strong>eBPF</strong> (Extended Berkeley Packet Filter).</li>
<li><strong>Justificación:</strong> Elimina la dependencia de <code>iptables</code> para el enrutamiento de servicios, permitiendo un throughput mayor y latencia menor. Habilita <strong>Hubble</strong> para generar un mapa de dependencias de red en tiempo real.</li>
</ul>
<h4 id="5-metallb-load-balancing">5. MetalLB (Load Balancing)<a class="headerlink" href="#5-metallb-load-balancing" title="Permanent link">&para;</a></h4>
<ul>
<li><strong>Modo:</strong> <strong>BGP</strong> (Border Gateway Protocol).</li>
<li><strong>Justificación:</strong> En lugar de usar ARP (Capa 2), configuramos MetalLB para hablar BGP con el router pfSense. Esto permite entender protocolos de enrutamiento dinámico y ECMP (Equal-Cost Multi-Path) para alta disponibilidad real de IPs de entrada.</li>
</ul>
<hr />
<h3 id="capa-3-plataforma-y-gitops">Capa 3: Plataforma y GitOps<a class="headerlink" href="#capa-3-plataforma-y-gitops" title="Permanent link">&para;</a></h3>
<p>La regla de oro: <strong>"Si no está en Git, no existe"</strong>. El acceso por SSH a los nodos o el uso de <code>kubectl apply</code> manual está prohibido para operaciones normales.</p>
<h4 id="6-fluxcd-gitops-controller">6. FluxCD (GitOps Controller)<a class="headerlink" href="#6-fluxcd-gitops-controller" title="Permanent link">&para;</a></h4>
<ul>
<li><strong>Mecanismo:</strong> Reconciliación continua.</li>
<li><strong>Justificación:</strong> El cluster "tira" (pull) de la configuración desde Git. Esto asegura recuperación ante desastres (DR) inmediata: si el cluster muere, se levanta uno nuevo, se instala Flux, y el estado se restaura solo.</li>
</ul>
<h4 id="7-tekton-ci-pipelines">7. Tekton (CI Pipelines)<a class="headerlink" href="#7-tekton-ci-pipelines" title="Permanent link">&para;</a></h4>
<ul>
<li><strong>Diferenciador:</strong> A diferencia de Jenkins o GitHub Actions, Tekton corre <em>dentro</em> del cluster como recursos nativos (CRDs).</li>
<li><strong>Justificación:</strong> Unifica el plano de control de la infraestructura y el del despliegue de software. Permite construir imágenes (con Kaniko) y desplegarlas sin salir del entorno de Kubernetes.</li>
</ul>
<h4 id="8-harbor-container-registry">8. Harbor (Container Registry)<a class="headerlink" href="#8-harbor-container-registry" title="Permanent link">&para;</a></h4>
<ul>
<li><strong>Funcionalidad:</strong> Almacenamiento de imágenes, escaneo de vulnerabilidades (Trivy) y firma de imágenes (Notary/Cosign).</li>
<li><strong>Justificación:</strong> Control total de la cadena de suministro de software (Software Supply Chain).</li>
</ul>
<hr />
<h3 id="capa-4-seguridad-y-politicas">Capa 4: Seguridad y Políticas<a class="headerlink" href="#capa-4-seguridad-y-politicas" title="Permanent link">&para;</a></h3>
<h4 id="9-opa-gatekeeper-policy-engine">9. OPA Gatekeeper (Policy Engine)<a class="headerlink" href="#9-opa-gatekeeper-policy-engine" title="Permanent link">&para;</a></h4>
<ul>
<li><strong>Concepto:</strong> Policy as Code.</li>
<li><strong>Implementación:</strong> Reglas escritas en lenguaje <strong>Rego</strong> que interceptan las peticiones al API Server.</li>
<li><strong>Casos de uso:</strong> Prohibir contenedores corriendo como <code>root</code>, exigir límites de recursos (CPU/RAM) y validar procedencia de imágenes.</li>
</ul>
<h4 id="10-gestion-de-secretos-sops-age">10. Gestión de Secretos (SOPS + Age)<a class="headerlink" href="#10-gestion-de-secretos-sops-age" title="Permanent link">&para;</a></h4>
<ul>
<li><strong>Justificación:</strong> Permite almacenar secretos en repositorios públicos o privados de forma segura. Los secretos se desencriptan únicamente dentro del cluster por el controlador de Flux.</li>
</ul>
<hr />
<h3 id="capa-5-observabilidad-stack-lgtm">Capa 5: Observabilidad (Stack LGTM)<a class="headerlink" href="#capa-5-observabilidad-stack-lgtm" title="Permanent link">&para;</a></h3>
<p>No es suficiente saber que algo falló; es necesario saber <em>por qué</em>, <em>dónde</em> y <em>cuándo</em> con precisión de milisegundos.</p>
<h4 id="11-victoriametrics-metricas">11. VictoriaMetrics (Métricas)<a class="headerlink" href="#11-victoriametrics-metricas" title="Permanent link">&para;</a></h4>
<ul>
<li><strong>Selección:</strong> Elegido sobre Prometheus por su eficiencia en almacenamiento y capacidad para manejar alta cardinalidad ("High Cardinality").</li>
</ul>
<h4 id="12-loki-logs">12. Loki (Logs)<a class="headerlink" href="#12-loki-logs" title="Permanent link">&para;</a></h4>
<ul>
<li><strong>Filosofía:</strong> "Like Prometheus, but for logs". No indexa el texto completo, solo metadatos, permitiendo correlación directa entre picos de métricas y líneas de logs mediante LogQL.</li>
</ul>
<h4 id="13-tempo-trazas-distribuidas">13. Tempo (Trazas Distribuidas)<a class="headerlink" href="#13-tempo-trazas-distribuidas" title="Permanent link">&para;</a></h4>
<ul>
<li><strong>Estándar:</strong> OpenTelemetry.</li>
<li><strong>Justificación:</strong> Permite visualizar la latencia en cada salto de una petición HTTP a través de múltiples microservicios (Ingress -&gt; Frontend -&gt; API -&gt; DB).</li>
</ul>
<hr />
<h3 id="capa-6-datos-y-persistencia">Capa 6: Datos y Persistencia<a class="headerlink" href="#capa-6-datos-y-persistencia" title="Permanent link">&para;</a></h3>
<p>El estado es la parte difícil de Kubernetes. KTSW aborda esto frontalmente.</p>
<h4 id="14-longhorn-block-storage">14. Longhorn (Block Storage)<a class="headerlink" href="#14-longhorn-block-storage" title="Permanent link">&para;</a></h4>
<ul>
<li><strong>Arquitectura:</strong> Storage distribuido nativo de nube. Convierte el almacenamiento local de los nodos en un pool replicado y resiliente.</li>
</ul>
<h4 id="15-cloudnativepg-postgresql">15. CloudNativePG (PostgreSQL)<a class="headerlink" href="#15-cloudnativepg-postgresql" title="Permanent link">&para;</a></h4>
<ul>
<li><strong>Operador:</strong> Gestiona el ciclo de vida de la base de datos: failover automático, backups a S3 (MinIO) y Point-in-Time Recovery (PITR).</li>
</ul>
<h4 id="16-nats-jetstream-messaging">16. NATS JetStream (Messaging)<a class="headerlink" href="#16-nats-jetstream-messaging" title="Permanent link">&para;</a></h4>
<ul>
<li><strong>Uso:</strong> Bus de mensajes para comunicación asíncrona entre microservicios, reemplazando REST para operaciones internas de alto rendimiento.</li>
</ul>
<hr />
<h2 id="5-aplicacion-de-referencia-distributed-task-processor">5. Aplicación de Referencia: "Distributed Task Processor"<a class="headerlink" href="#5-aplicacion-de-referencia-distributed-task-processor" title="Permanent link">&para;</a></h2>
<p>Para validar la infraestructura, se desarrollará una aplicación que ejercite todos los componentes.</p>
<p><strong>Componentes de la App:</strong></p>
<ol>
<li><strong>API Gateway (Go):</strong> Recibe requests, valida JWT (Keycloak), deposita trabajos en NATS.</li>
<li><strong>Worker Pool (Rust/Go):</strong> Escucha NATS, escala horizontalmente (HPA) basado en la profundidad de la cola, procesa datos y guarda en Postgres.</li>
<li><strong>Status Service (Node):</strong> Lee de Redis (Caché) y Postgres para dar feedback al usuario vía WebSockets.</li>
</ol>
<hr />
<h2 id="6-roadmap-de-implementacion">6. Roadmap de Implementación<a class="headerlink" href="#6-roadmap-de-implementacion" title="Permanent link">&para;</a></h2>
<h3 id="fase-0-fundamentos-la-base-fisica">Fase 0: Fundamentos (La Base Física)<a class="headerlink" href="#fase-0-fundamentos-la-base-fisica" title="Permanent link">&para;</a></h3>
<ul>
<li>Configuración de Proxmox y Networking físico.</li>
<li>Definición de VLANs y reglas de Firewall en pfSense.</li>
<li>Bootstrap de cluster Kubernetes (k3s hard mode).</li>
</ul>
<h3 id="fase-1-conectividad-y-seguridad-la-red">Fase 1: Conectividad y Seguridad (La Red)<a class="headerlink" href="#fase-1-conectividad-y-seguridad-la-red" title="Permanent link">&para;</a></h3>
<ul>
<li>Despliegue de <strong>Cilium</strong> y eliminación de kube-proxy.</li>
<li>Configuración de <strong>MetalLB</strong> en modo BGP.</li>
<li>Implementación de Ingress Controller (Traefik) y Cert-Manager.</li>
</ul>
<h3 id="fase-2-control-y-gitops-el-cerebro">Fase 2: Control y GitOps (El Cerebro)<a class="headerlink" href="#fase-2-control-y-gitops-el-cerebro" title="Permanent link">&para;</a></h3>
<ul>
<li>Estructuración del repositorio de GitOps.</li>
<li>Bootstrap de <strong>FluxCD</strong>.</li>
<li>Configuración de encriptación de secretos (SOPS).</li>
<li>Definición de políticas de admisión (Gatekeeper).</li>
</ul>
<h3 id="fase-3-observabilidad-los-ojos">Fase 3: Observabilidad (Los Ojos)<a class="headerlink" href="#fase-3-observabilidad-los-ojos" title="Permanent link">&para;</a></h3>
<ul>
<li>Despliegue del stack LGTM (Loki, Grafana, Tempo, VictoriaMetrics).</li>
<li>Instrumentación básica de componentes del sistema.</li>
<li>Creación de Dashboards "Golden Signals".</li>
</ul>
<h3 id="fase-4-datos-y-plataforma-el-musculo">Fase 4: Datos y Plataforma (El Músculo)<a class="headerlink" href="#fase-4-datos-y-plataforma-el-musculo" title="Permanent link">&para;</a></h3>
<ul>
<li>Estabilización de almacenamiento persistente (Longhorn).</li>
<li>Despliegue de servicios de datos (Postgres, Redis, NATS).</li>
<li>Configuración de Registry privado (Harbor).</li>
</ul>
<h3 id="fase-5-aplicacion-y-pipelines-la-carga">Fase 5: Aplicación y Pipelines (La Carga)<a class="headerlink" href="#fase-5-aplicacion-y-pipelines-la-carga" title="Permanent link">&para;</a></h3>
<ul>
<li>Creación de pipelines de CI en <strong>Tekton</strong>.</li>
<li>Desarrollo y despliegue de la aplicación "Distributed Task Processor".</li>
<li>Implementación de HPA (Horizontal Pod Autoscaling) basado en métricas custom.</li>
</ul>
<h3 id="fase-6-operaciones-dia-2-y-caos-la-prueba-de-fuego">Fase 6: Operaciones Día 2 y Caos (La Prueba de Fuego)<a class="headerlink" href="#fase-6-operaciones-dia-2-y-caos-la-prueba-de-fuego" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Backup &amp; DR:</strong> Implementación de Velero y pruebas de restauración total.</li>
<li><strong>Chaos Engineering:</strong> Instalación de <strong>Litmus Chaos</strong>.</li>
<li><em>Experimento 1:</em> Eliminar pod de base de datos master (validar failover).</li>
<li><em>Experimento 2:</em> Introducir latencia de red (validar timeouts y circuit breakers).</li>
<li><em>Experimento 3:</em> Pérdida completa de un nodo worker (validar reprogramación de pods).</li>
</ul>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../../..", "features": ["content.code.copy", "content.code.annotate", "navigation.instant", "navigation.tabs", "navigation.sections", "navigation.top", "navigation.tracking", "search.suggest", "search.highlight", "search.share"], "search": "../../../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../../assets/javascripts/bundle.79ae519e.min.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>